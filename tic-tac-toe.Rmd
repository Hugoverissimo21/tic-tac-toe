---
title: "Tic-Tac-Toe"
author: "Hugo Ver√≠ssimo"
output: pdf_document
date: \today
---

# Introduction


\begin{tabular}{c|c|c}
  1 & 2 & 3 \\      \hline
  4 & 5 & 6 \\      \hline
  7 & 8 & 9
\end{tabular}

```{python imports}
import numpy as np
import pandas as pd
```

\pagebreak

# How many games

using NUMPY to get more efficient since all lists are only int numbers

```{python ALL_tic_tac_toe}
def ALL_tic_tac_toe():
    """
    generate all tic-tac-toe games but,
        doesn't care who starts (X or O)
        doesn't care if theres a win, just fills all the nine squares
        impar numbers stand for the first player
        it's justs all the 9! games
    """
    move = 0
    ith_move = np.array([[0,0,0 , 0,0,0 , 0,0,0], [0,0,0 , 0,0,0 , 0,0,0]])
    
    move = 1
    while move < 9:
        all_games = np.array([0,0,0 , 0,0,0 , 0,0,0])
        list_all_games = [all_games]
        for j in range(1, len(ith_move)):
            for i in range(9):
                if ith_move[j][i] != 0:
                    pass
                else:
                    ith_move[j][i] = move
                    list_all_games.append(ith_move[j].copy())
                    ith_move[j][i] = 0
        ith_move = np.vstack(list_all_games)
        #print("Move " + str(move) + " - OK")
        move += 1    

    move = 9
    last_move = np.where(ith_move[1:] == 0, 9, ith_move[1:])
    #print("Move " + str(move) + " - OK")

    np.savetxt("attachment(1)_alltictactoe.csv", last_move, delimiter=",", fmt="%d")

    return "File saved.", len(last_move)
  
ALL_tic_tac_toe()
```

lets use pandas to preview da csv

```{python preview-ALL_tic_tac_toe}
pd.read_csv("attachment(1)_alltictactoe.csv", header = None)
```

we can see we have the 9! ....

since we now have all the possible games lets see the ones according to the possible win using only NUMPY

```{python TRUE_tic_tac_toe}
def TRUE_tic_tac_toe():
    """
    remove the games from the set of 9! games where there are wins
    """
    def is_there_a_win(ttt):
        # convert 1D array into 2D array (3 by 3)
        TTT = ttt.reshape(3,3)

        # lines to verify for wins (lines, columns, diagonals)
        lines = np.vstack([TTT, np.transpose(TTT), np.diag(TTT), np.diag(np.fliplr(TTT))])
        
        # check sums to see if there is a winner
        X_vs_O = np.where(lines % 2 == 1, 1, -1)
        sums = np.sum(X_vs_O, axis=1)

        # someone won
        if 3 in np.abs(sums):
            # find the winning move
            last_move = np.max(lines, axis=1)
            last_move[np.abs(sums) != 3] = 10
            return True, min(last_move)

        # draw game
        else:
            return False, 0
        

    with open("attachment(1)_alltictactoe.csv", "r") as csvfile:
        rows = [line.strip().split(',') for line in csvfile]

    new_games = []
    for row in rows:
        ttt = np.array(row).astype(float)
        win = is_there_a_win(ttt)
        if win[0]:
            ttt[ttt > win[1]] = 0
            new_games.append(ttt)
        else:
            new_games.append(ttt)

    processed_games = np.vstack(new_games)
    unique_games = np.unique(processed_games, axis=0)

    np.savetxt("attachment(2)_truetictactoe.csv", unique_games, delimiter=",", fmt="%d")

    return "File saved.", len(unique_games)

TRUE_tic_tac_toe()
```

as we can see we got the possiblities down to ... (% decrease from original)

lets see the csv using pandas

```{python preview-TRUE_tic_tac_toe}
pd.read_csv("attachment(2)_truetictactoe.csv", header = None)
```
